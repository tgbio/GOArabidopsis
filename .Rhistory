<<<<<<< HEAD
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
}
}
}
source("http://bioconductor.org/biocLite.R")
biocLite("GOFunction")
library('GOFunction')
library('org.At.tair.db')
library("biomaRt")
#retrieve mapping between TAIR ID and Entrez Gene identifiers
all.at.genes <- org.At.tairENTREZID
#converts mapped ids to a list
mapped.at.genes <- mappedkeys(all.at.genes)
#qtl_at_ids = list("AT_ids_between_CH.215L_and_HH.360L.csv", "AT_ids_between_DF.408C_and_FD.90L.csv")
qtl_at_ids = list("AT_ids_between_F4I1_and_MSAT2.22.csv", "AT_ids_between_GH.473C_and_HH.480C.csv", "AT_ids_between_PVV4_and_HH.335C.csv")
ont_type = list("MF", "BP", "CC")
for (q in qtl_at_ids) { # loop over each csv filename in list qtl_at_ids
qtl_genes = read.csv(q,header=F)$V1 # read AT IDs of protein coding genes within QTL region into a vector
for (o in ont_type) { # for each type of ontology
print(o)
region_fragment = substr(q, 16, regexpr("csv", q, fixed=T)[1]-2) # return the region name from the csv filename
print(region_fragment)
outfilename = paste(region_fragment, "_GO_", o, sep = "") # generate a unique filename for the GO output
=======
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
print(sigTerm)
num_gen = length(geneID) # count the number of genes in QTL region
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
>>>>>>> FETCH_HEAD
print(outfilename)
num_gen = length(geneID) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
<<<<<<< HEAD
print(qtl_genes)
sigTerm = GOFunction(qtl_genes, mapped.at.genes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
if(length(sigTerm) > 0){
print(sigTerm)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
}
}
}
#qtl_at_ids = list("AT_ids_between_F4I1_and_MSAT2.22.csv", "AT_ids_between_GH.473C_and_HH.480C.csv", "AT_ids_between_PVV4_and_HH.335C.csv")
library('GOFunction')
library('org.At.tair.db')
library("biomaRt")
#retrieve mapping between TAIR ID and Entrez Gene identifiers
all.at.genes <- org.At.tairENTREZID
#converts mapped ids to a list
mapped.at.genes <- mappedkeys(all.at.genes)
qtl_at_ids = list("AT_ids_between_CH.215L_and_HH.360L.csv", "AT_ids_between_DF.408C_and_FD.90L.csv")
#qtl_at_ids = list("AT_ids_between_F4I1_and_MSAT2.22.csv", "AT_ids_between_GH.473C_and_HH.480C.csv", "AT_ids_between_PVV4_and_HH.335C.csv")
=======
####line below: do with test IDs
sigTerm = GOFunction(geneID, mapped.at.genes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
?GoFunction
?GOFunction
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
library('GOFunction')
library('org.At.tair.db')
blastfile = "CORRECTEDTESTLOCALBLAST_QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI.csv"
blastrecord = read.csv(blastfile, header=F)
species = blastrecord$V18
atonly = blastrecord[species=="Arabidopsis thaliana", ]
interestGenes = as.character(atonly$V13)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairENTREZID)
#GO function takes GeneIDs so no conversion required
>>>>>>> FETCH_HEAD
ont_type = list("MF", "BP", "CC")
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
<<<<<<< HEAD
print(qtl_genes)
sigTerm = GOFunction(qtl_genes, mapped.at.genes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
=======
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
>>>>>>> FETCH_HEAD
if(length(sigTerm) > 0){
print(sigTerm)
}
}
atonlyTAIR <- mappedkeys(org.At.tairGO2TAIR)
atonlyTGID <- mappedkeys(org.At.tairENTREZID)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
<<<<<<< HEAD
}
}
}
}
?GOFunction
library('GOFunction')
library('org.At.tair.db')
library("biomaRt")
#retrieve mapping between TAIR ID and Entrez Gene identifiers
all.at.genes <- org.At.tairENTREZID
#converts mapped ids to a list
mapped.at.genes <- mappedkeys(all.at.genes)
qtl_at_ids = list("ABC_transporter_geneids.csv")#, "AT_ids_between_DF.408C_and_FD.90L.csv")
#qtl_at_ids = list("AT_ids_between_F4I1_and_MSAT2.22.csv", "AT_ids_between_GH.473C_and_HH.480C.csv", "AT_ids_between_PVV4_and_HH.335C.csv")
=======
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
library('GOFunction')
library('org.At.tair.db')
interestGenes = "AT_ids_between_AT_ids_test"
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairENTREZID)
>>>>>>> FETCH_HEAD
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "itworked" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
<<<<<<< HEAD
print(qtl_genes)
sigTerm = GOFunction(qtl_genes, mapped.at.genes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
=======
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
>>>>>>> FETCH_HEAD
if(length(sigTerm) > 0){
print(sigTerm)
atonlyTAIR <- mappedkeys(org.At.tairGO2TAIR)
atonlyTGID <- mappedkeys(org.At.tairENTREZID)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
<<<<<<< HEAD
}
}
}
}
setwd("~/Documents/Data/GOArabidopsis")
library('GOFunction')
library('org.At.tair.db')
library("biomaRt")
#retrieve mapping between TAIR ID and Entrez Gene identifiers
all.at.genes <- org.At.tairENTREZID
#converts mapped ids to a list
mapped.at.genes <- mappedkeys(all.at.genes)
qtl_at_ids = list("ABC_transporter_geneids.csv")#, "AT_ids_between_DF.408C_and_FD.90L.csv")
#qtl_at_ids = list("AT_ids_between_F4I1_and_MSAT2.22.csv", "AT_ids_between_GH.473C_and_HH.480C.csv", "AT_ids_between_PVV4_and_HH.335C.csv")
=======
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
?head
?head
head(org.At.tairENTREZID)
interestGenes = "AT_ids_between_AT_ids_test"
interestGenes <- org.At.tairREFSEQ
# Get the TAIR identifiers that are mapped to any RefSeq ID
mapped_genes <- mappedkeys(interestGenes)
# Convert to a list
xx <- as.list(x[mapped_genes])
x <- org.At.tairREFSEQ
# Get the TAIR identifiers that are mapped to any RefSeq ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the REFSEQ for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
?mappedkeys
summary(interestGenes)
library('GOFunction')
library('org.At.tair.db')
blastfile = "CORRECTEDTESTLOCALBLAST_QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI.csv"
blastrecord = read.csv(blastfile, header=F)
species = blastrecord$V18
atonly = blastrecord[species=="Arabidopsis thaliana", ]
interestGenes = as.character(atonly$V14)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairENTREZID)
#GO function takes GeneIDs so no conversion required
ont_type = list("MF", "BP", "CC")
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0){
print(sigTerm)
}
}
atonlyTAIR <- mappedkeys(org.At.tairGO2TAIR)
atonlyTGID <- mappedkeys(org.At.tairENTREZID)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
interestGenes = "AT_ids_test_set"
summary(interestGenes)
interestGenes = "AT_ids_test_set"
summary(interestGenes)
head(interestGenes)
show(interestGenes)
summary(refGenes)
interestGenes = "AT_ids_test_set"
show(interestGenes)
interestGenes <- mappedkeys(org.At.tairENTREZID)
x <- org.At.tairREFSEQ
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairENTREZID)
str(interestGenes)
library('GOFunction')
library('org.At.tair.db')
interestGenes = "AT_ids_test_set"
str(interestGenes)
map <- mappedkeys(org.At.tairENTREZID)
>>>>>>> FETCH_HEAD
ont_type = list("MF", "BP", "CC")
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(map) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
<<<<<<< HEAD
print(qtl_genes)
sigTerm = GOFunction(qtl_genes, mapped.at.genes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
=======
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, map, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0){
print(sigTerm)
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
library('GOFunction')
library('org.At.tair.db')
interestGenes = "AT_ids_test_set"
str(interestGenes)
map <- mappedkeys(org.At.tairENTREZID)
ont_type = list("MF", "BP", "CC")
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(map) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, map, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0){
print(sigTerm)
for (o in ont_type) { # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(map) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, map, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0){
print(sigTerm)
ont_type = list("MF", "BP", "CC")
for (o in ont_type) { # for each type of ontology
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(map) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, map, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
>>>>>>> FETCH_HEAD
if(length(sigTerm) > 0){
print(sigTerm)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
}
}
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.csv(csv.in,header=F)$V1 # read AT IDs of protein coding genes within QTL region into a vector
at_ids = read.csv(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids
str(at_ids)
sindex = grep(as.character(at_ids[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids[i,1]), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids), names(xx), fixed=TRUE, value = FALSE)
at_ids.df = data.frame(at_ids)
str(at_ids.df)
at_ids.df = data.frame(at_ids)
at_ids.df.t = t(at_ids.df)
at_ids.df.t
sindex = grep(as.character(at_ids), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids[[1,1]]), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids[1,1]), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids[,1]), names(xx), fixed=TRUE, value = FALSE)
sindex = grep(as.character(at_ids[1,]), names(xx), fixed=TRUE, value = FALSE)
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids.df = data.frame(at_ids)
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids
str(at_ids)
at_ids[1,1]
at_ids[1]
library('GOFunction')
library('org.At.tair.db')
<<<<<<< HEAD
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
sindex = grep(as.character(at_ids[1,]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
sindex
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
=======
interestGenes = "AT_ids_test_set"
str(interestGenes)
map <- mappedkeys(org.At.tairENTREZID)
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "working" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(map) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, map, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0)
print(sigTerm)
library('GOFunction')
library('org.At.tair.db')
blastfile = "CORRECTEDTESTLOCALBLAST_QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI.csv"
blastrecord = read.csv(blastfile, header=F)
species = blastrecord$V18
atonly = blastrecord[species=="Arabidopsis thaliana",]
interestGenes = as.character(atonly$V14)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairREFSEQ)
#GO function takes GeneIDs so no conversion required
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0)
print(sigTerm)
atonlyTAIR <- mappedkeys(org.At.tairGO2TAIR)
atonlyTGID <- mappedkeys(org.At.tairENTREZID)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
>>>>>>> FETCH_HEAD
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
<<<<<<< HEAD
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
sindex
=======
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
str(map)
str(map)
str(interestGenes)
map <- mappedkeys(org.At.tairREFSEQ)
str(map)
map <- mappedkeys(org.At.tairREFSEQ)
str(map)
map <- org.At.tairREFSEQ
str(map)
str(map.3)
str(map[3])
hv
str(map[3])
str(map$2])
str(map$2)
str(map$2)
str(map)
str(map$tablename)
str(map$cat)
str(map$2@1)
str(map$1)
str(map$tableref)
str(map)
str(map$objName)
print(map$objName)
print(map)
print(map)
print org.At.tairREFSEQ
print(org.At.tairREFSEQ)
print(map)
str(map)
str(map)
print(map$objName)
str(map)
refGenes <- mappedkeys(org.At.tairREFSEQ)
str(refGenes)
str(interestGenes)
ATinterestGenes <- mappedkeys(org.At.tairREFSEQ)
str(ATinterestGenes)
str(ATinterestGenes)
interestGenes = as.character(atonly$V14)
str(interestGenes)
ATinterestGenes <- mappedkeys(interestGenes)
interestGenes = as.character(atonly$V14)
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairREFSEQ)
str(ATinterestGenes)
str(interestGenes)
?mappedkeys
interestGenes <- org.At.tairREFSEQ
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairREFSEQ)
str(interestGenes)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairREFSEQ)
str(refGenes)
interestGenes = as.character(atonly$V14)
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairREFSEQ)
interestGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(interestGenes)
refGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(refGenes)
interestGenes = as.character(atonly$V14)
str(interestGenes)
str(interestGenes)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(refGenes)
#GO function takes GeneIDs so no conversion required
library('GOFunction')
library('org.At.tair.db')
blastfile = "CORRECTEDTESTLOCALBLAST_QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI.csv"
blastrecord = read.csv(blastfile, header=F)
species = blastrecord$V18
atonly = blastrecord[species=="Arabidopsis thaliana",]
interestGenes = as.character(atonly$V14)
str(interestGenes)
str(interestGenes)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(refGenes)
#GO function takes GeneIDs so no conversion required
?mappedkeys
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
print(sigTerm)
if(length(sigTerm) > 0)
print(sigTerm)
atonlyTAIR <- mappedkeys(org.At.tairGO2TAIR)
atonlyTGID <- mappedkeys(org.At.tairENTREZID)
#adapted from the org.At.tair.db vignette for org.At.tairGO2ALLTAIRS
# provides mappings between a given GO identifier and all TAIR identifiers annotated at that GO term or one of its children in the GO ontology
#xx is a list with names = GO ids, values = a named list with values of AT ids and names of evidence codes
csv.out = paste(outfilename, "_GO_signif_ATIDs.csv", sep = "")
print(csv.out)
xx <- as.list(org.At.tairGO2ALLTAIRS)
for (i in 1:nrow(sigTerm)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(sigTerm[[i,1]]), names(xx), fixed=TRUE, value = FALSE)
>>>>>>> FETCH_HEAD
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
<<<<<<< HEAD
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
sindex
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(sigTerm[[i,1]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
sindex
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(at_ids[i]]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
sindex
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% qtl_genes]
out_df = c(as.character(at_ids[i]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
library('GOFunction')
library('org.At.tair.db')
##Adapted from org.At.tair.db vignette example for org.At.tairENTREZID: Map TAIR identifiers with Entrez Gene identifiers
x <- org.At.tairENTREZID
# Get the ORF IDs that are mapped to an Entrez Gene ID
mapped_genes <- mappedkeys(x)
# Convert to a list
xx <- as.list(x[mapped_genes])
if(length(xx) > 0) {
# Get the Entrez gene IDs for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
}
csv.in = "AT_ids_between_markers_example.csv"
at_ids = read.table(csv.in,header=F)$V1 # read AT IDs of protein coding genes within region into a vector
at_ids[1]
#sindex = grep(as.character(at_ids[1]), names(xx), fixed=TRUE, value = FALSE)
csv.out = "GIds_from_ATIDs.csv"
print(csv.out)
xx <- as.list(org.At.tairENTREZID)
for (i in 1:length(at_ids)){
# Gets the tair identifiers for the significant GO term
sindex = grep(as.character(at_ids[[i]]), names(xx), fixed=TRUE, value = FALSE)
sindex
goid <- xx[sindex]
stopifnot(length(goid)==1)
# Gets all the tair identifiers for significant GO term
at_id_char = as.character(goid[[1]])
at_id_list = as.list(at_id_char)
# Select just those tair identifiers also in qtl_genes
gene_list = at_id_list[at_id_list %in% at_ids]
out_df = c(as.character(at_ids[i]), gene_list)
print(str(out_df))
write.table(out_df, csv.out, append=TRUE,col.names=FALSE, row.names=FALSE, sep=",")
}
=======
#LOOK FOR LINKAGE BETWEEN TAIR IDENTIFIERS and GENE IDs; between GI, and GO term
#look at documentation
#use p10 in the bioonductor viniette for the code on how to pull these out
#go to NCBI, find a AT gene, take the accession#/gene id list and run as a positive control
#output will be a list of the enriched genes, that have been put into a
interestGenes = as.character(atonly$V14)
str(interestGenes)
interestGenes = as.character(atonly$V14)
str(interestGenes)
refGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(refGenes)
blastfile = "CORRECTEDTESTLOCALBLAST_QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI.csv"
blastrecord = read.csv(blastfile, header=F)
species = blastrecord$V18
atonly = blastrecord[species=="Arabidopsis thaliana",]
interestGenes = as.character(atonly$V14)
str(interestGenes)
#retrieve mapping between TAIR ID and Entrez Gene identifiers then converts mapped ids to a list
refGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(refGenes)
#GO function takes GeneIDs so no conversion required
?mappedkeys
ont_type = list("MF", "BP", "CC")
for (o in ont_type) # for each type of ontology
print(o)
outfilename = "QGG24G02.yg.ab1_CLS_S3_Contig10858_LettuceNCBI_Athaliana" # generate a unique filename for the GO output
print(outfilename)
num_gen = length(interestGenes) # count the number of genes in QTL region
print("Number of Genes:")
print(num_gen)
####line below: do with test IDs
sigTerm = GOFunction(interestGenes, refGenes, organism="org.At.tair.db", ontology=o, fdrmethod="BY", fdrth=0.05, ppth=0.05, pcth=0.05, poth=0.05, peth=0.05, bmpSize=2000, filename=outfilename) # find GO terms enriched in region
?GOFunction
interestGenes = as.character(atonly$V14)
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairENTREZID)
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairREFSEQ2TAIR)
str(interestGenes)
interestGenes <- mappedkeys(org.At.tairREFSEQ)
str(interestGenes)
x <- org.At.tairREFSEQ
# Get the TAIR identifiers that are mapped to any RefSeq ID
interestGenes <- mappedkeys(x)
xx <- as.list(x[interestGenes])
if(length(xx) > 0) {
# Get the REFSEQ for the first five genes
xx[1:5]
# Get the first one
xx[[1]]
(xx)
(xx)
len(xx)
length(xx)
?GOFunction
>>>>>>> FETCH_HEAD
